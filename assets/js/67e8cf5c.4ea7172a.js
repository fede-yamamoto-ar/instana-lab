"use strict";(self.webpackChunkswat_hub=self.webpackChunkswat_hub||[]).push([[602],{5205:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"type":"mdx","permalink":"/fede-yamamoto-ar/instana-lab/snippets/","source":"@site/src/pages/snippets/index.md","description":"Lab Snippets","frontMatter":{},"unlisted":false}');var a=t(4848),o=t(8453);const l={},c=void 0,r={},i=[{value:"Lab Snippets",id:"lab-snippets",level:2},{value:"Manually update your clusters Global Pull Secret",id:"manually-update-your-clusters-global-pull-secret",level:3},{value:"Manually install Quote of the Day",id:"manually-install-quote-of-the-day",level:3},{value:"Manually create the Robot Shop Redis PV/PVC",id:"manually-create-the-robot-shop-redis-pvpvc",level:3}];function d(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"lab-snippets",children:"Lab Snippets"}),"\n",(0,a.jsx)(n.h3,{id:"manually-update-your-clusters-global-pull-secret",children:"Manually update your clusters Global Pull Secret"}),"\n",(0,a.jsx)(n.p,{children:"Set the pull secret username and password:"}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"<pull-secret-user>"})," and ",(0,a.jsx)(n.code,{children:"<pull-secret-pass>"})," are obtained by creating a\nDockerHub account."]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'export USER="<pull-secret-user>"\nexport PASS="<pull-secret-pass>"\n'})}),"\n",(0,a.jsx)(n.p,{children:"Update the pull secret by running the following commands:"}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"These commands use the above set variables. There is no need to edit them."})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'oc get secret/pull-secret -n openshift-config --kubeconfig ~/kubeconfig-apps --template=\'{{index .data ".dockerconfigjson" | base64decode}}\' > pullSecret\n\noc registry login --kubeconfig ~/kubeconfig-apps --registry="docker.io" --auth-basic="${USER}:${PASS}" --to=pullSecret\n\noc set data secret/pull-secret -n openshift-config --kubeconfig ~/kubeconfig-apps --from-file=.dockerconfigjson=pullSecret\n'})}),"\n",(0,a.jsx)(n.h3,{id:"manually-install-quote-of-the-day",children:"Manually install Quote of the Day"}),"\n",(0,a.jsx)(n.p,{children:"To install the QOTD application run the following commands from the bastion\nhost:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"export KUBECONFIG=/home/admin/kubeconfig-apps\nDOMAIN=apps.sno.techzone.lan\n\noc new-project qotd\noc adm policy add-scc-to-user anyuid -z default\n\noc new-project qotd-load\noc adm policy add-scc-to-user anyuid -z default\n\nhelm repo add qotd https://gitlab.com/api/v4/projects/26143345/packages/helm/stable\nhelm repo update\n\nhelm install qotd qotd/qotd \\\n  -n qotd \\\n  --set appNamespace=qotd \\\n  --set loadNamespace=qotd-load \\\n  --set host=${DOMAIN} \\\n  --set enableInstana=true \\\n  --set roksCluster=true\n"})}),"\n",(0,a.jsx)(n.h3,{id:"manually-create-the-robot-shop-redis-pvpvc",children:"Manually create the Robot Shop Redis PV/PVC"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'cat <<EOF | oc create --kubeconfig ~/kubeconfig-apps -f -\n---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: robot-shop-redis-pv-test\n  labels:\n    type: local\nspec:\n  capacity:\n    storage: 1Gi\n  accessModes:\n    - ReadWriteOnce\n  persistentVolumeReclaimPolicy: Retain\n  hostPath:\n    path: "/mnt/robotshop"\n---\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: data-redis-0\n  namespace: robot-shop\n  labels:\n    service: redis\nspec:\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 1Gi\n  volumeMode: Filesystem\nEOF\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var s=t(6540);const a={},o=s.createContext(a);function l(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);